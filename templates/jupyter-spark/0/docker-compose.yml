version: "2"
services:
  jupyter:
    image: jupyter/all-spark-notebook
    ports:
      - ${PORT}:8888
    environment:
      GEN_CERT: "yes"
      GRANT_SUDO: "yes"
    command:
       openssl req -x509 -newkey rsa:4096 -subj '/CN=eltitopera.zapto.org' -keyout /etc/ssl/notebook/notebook.key -out /etc/ssl/notebook/notebook.crt -days 365
       start-notebook.sh --NotebookApp.token='${TOKEN}'--NotebookApp.keyfile=/etc/ssl/notebook/notebook.key --NotebookApp.certfile=/etc/ssl/notebook/notebook.crt
    volumes:
      - data:/home/jovyan

volumes:
  data:
      driver: rancher-nfs 
